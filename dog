#!/usr/bin/env python

import sys
import matplotlib.pyplot as plt
from matplotlib.backends.backend_pdf import PdfPages
import csv

if len(sys.argv) == 1:
    print("dog <id>")
    sys.exit(0)

if sys.argv[1] == "1" or sys.argv[1] == "2":
    pp = PdfPages('dog%s.pdf' % sys.argv[1])
    print("Creating dog%s.pdf" % sys.argv[1])

    skip = []
    if sys.argv[1] == "2":
        skip.append('simple_4')
        skip.append('simple_5')
    #
    # Read expr.csv
    #
    data = []
    with open('benchmarks/expr.csv', 'r') as f:
        reader = csv.reader(f)
        flag = True
        for row in reader:
            if flag:
                header = row
                flag = False
                continue
            data.append( row )
    p = {}
    labels = {}
    for row in data:
        if row[1] not in labels:
            labels[row[1]] = []
        if not row[2] in labels[row[1]]:
            labels[row[1]].append(row[2])
        if row[6] == "":
            continue

        if row[1] not in p:
            p[row[1]] = {}
        if row[3] not in p[row[1]]:
            p[row[1]][row[3]] = set()
        p[row[1]][row[3]].add((row[2], float(row[6])))
    #
    # Plot 
    #
    for python in p:
        for line in p[python]:
            if line.startswith('simple'):
                if line in skip:
                    continue
                x_ = [-1]*len(labels[python])
                y_ = [-1]*len(labels[python])
                #print(line)
                #print(p[python][line])
                for x,y in p[python][line]:
                    i = labels[python].index(x)
                    x_[i] = i
                    y_[i] = y
                #print(x_)
                #print(y_)
                x__ = []
                y__ = []
                for i in range(len(x_)):
                    if x_[i] != -1:
                        x__.append(x_[i])
                        y__.append(y_[i])
                if len(x__) == 1:
                    plt.plot(x__, y__, 'o', markersize=3, label=line)
                else:
                    plt.plot(x__, y__, label=line)

        plt.xlabel("X Label")
        plt.ylabel("Y Label")
        plt.title(python)
        plt.legend()

        #print(labels[python])
        plt.xticks(range(len(labels[python])), labels[python])
        #plt.show()
        pp.savefig()
        plt.clf()

    pp.close()


